<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="box">
        <label for="unDebounce">没有防抖的input</label>
        <input type="text" id="unDebounce" placeholder="请输入关键字">
    </div>
<script>
    // html css js
    // js 语言？ 浆糊.html css
    // 百度搜索 search suggest
    // 全局作用域 js 当前单线程global window
    let inputa = document.getElementById('unDebounce');
    // JS 一切复杂类型都是对象，具体式Object的哪个子类型 面向对象编程
    // [object HTMLInputElement][object CSSStyleDeclaration]
    // console.log(Object.prototype.toString.call(inputa.style));
    inputa.addEventListener('keyup',function(e) {
        // console.log(Object.prototype.toString.call(e));
        // console.log(e.key,e.keyCode);
        // JS 主动拉取数据 fetch ajax(XMLhttpRequest)
        // 模块化, 用户输入
        // 频繁的事件
        // ajax是高阶函数(参数或返回的值是一个函数)
        // 回调函数解决一个
        let res = ajax(e.target.value,(res) => {
            console.log(res,'//');
        }); // 异步思想 js单线程语言
        console.log(res,'//!!');
    })
    function ajax(keyword, cb) {
        // 耗时的异步 xhr
        // 去请求 通过http协议再去后端拉取
        // 数据格式 json ,最早是 XML
        const xhr = new XMLHttpRequest();// jser 前后端分离,前端拉取数据的核心对象 
        // Get HTTP Method
        // URL
        // JSON
        // 打开一个请求通道
        // console.log(Object.prototype.toString.call(xhr),xhr.readyState); // 0  UNSENT 代理被创建，但尚未调用 open() 方法。
        xhr.open('GET',"https://www.fastmock.site/mock/995214af813bc47208cf2fcb558907e6/mall/home/multidata")
        xhr.send() // 请求才真正的发送出去了
        // DOM 0
        // console.log(xhr.readyState); // 1 OPENED open() 方法已经被调用。
        xhr.onreadystatechange = function() {
            // 2 HEADERS_RECEIVED send() 方法已经被调用，并且头部和状态已经可获得   发送响应头 200 可以成功响应你
            // 3 LOADING 下载中；属性已经包含部分数据
            // 4 DONE 数据完全到达
            // console.log(xhr.readyState,'////');// 2,3,4
            if(xhr.readyState == 4) {
                // console.log(JSON.parse(xhr.responseText));
                // cb是一个回调函数 callback 简写
                cb(JSON.parse(xhr.responseText));
            }
        }
    }

</script>
</body>
</html>